[2025-09-19T22:07:02Z] Starting acceptance tests
[2025-09-19T22:07:02Z] Running pytest --maxfail=1 --cov=start_spiral_os --cov=spiral_os --cov=spiral_memory --cov=spiral_vector_db --cov=vector_memory --cov=src/spiral_os --cov-fail-under=90 tests/test_start_spiral_os.py tests/test_spiral_os.py tests/integration/test_razar_failover.py tests/test_spiral_memory.py tests/test_vector_memory.py tests/test_vector_memory_extensions.py tests/test_vector_memory_persistence.py tests/test_spiral_vector_db.py tests/crown/test_replay_determinism.py -k not test_razar_failover_chain_escalates_through_air_star_to_rstar and not test_crown_replay_determinism
===================================================== test session starts ======================================================
platform linux -- Python 3.12.10, pytest-8.4.1, pluggy-1.6.0
rootdir: /workspace/ABZU
configfile: pytest.ini
plugins: requests-mock-1.12.1, timeout-2.4.0, anyio-4.10.0, cov-7.0.0, langsmith-0.4.29

----------------------------------------------------- live log collection ------------------------------------------------------
WARNING  env_validation:env_validation.py:40 Optional package scapy not available: No module named 'scapy'
collected 95 items / 2 deselected / 93 selected

tests/test_start_spiral_os.py::test_sequence_with_network 
-------------------------------------------------------- live log call ---------------------------------------------------------
INFO     emotional_state:emotional_state.py:198 last_emotion set to neutral
INFO     start_spiral_os:start_spiral_os.py:212 Project summary: sum
INFO     start_spiral_os:start_spiral_os.py:220 Startup self-correction for neutral (tol 0.000)
PASSED                                                                                                                   [  1%]
tests/test_start_spiral_os.py::test_sequence_skip_network 
-------------------------------------------------------- live log call ---------------------------------------------------------
INFO     emotional_state:emotional_state.py:198 last_emotion set to neutral
INFO     start_spiral_os:start_spiral_os.py:212 Project summary: sum
INFO     start_spiral_os:start_spiral_os.py:220 Startup self-correction for neutral (tol 0.000)
PASSED                                                                                                                   [  2%]
tests/test_start_spiral_os.py::test_logging_fallback_branch 
-------------------------------------------------------- live log call ---------------------------------------------------------
WARNING  start_spiral_os:start_spiral_os.py:74 Vector memory module missing; system status not stored
WARNING  start_spiral_os:start_spiral_os.py:208 Vector memory module missing; initial listen not stored
PASSED                                                                                                                   [  3%]
tests/test_start_spiral_os.py::test_command_parsing 
-------------------------------------------------------- live log call ---------------------------------------------------------
INFO     emotional_state:emotional_state.py:198 last_emotion set to neutral
INFO     start_spiral_os:start_spiral_os.py:212 Project summary: None
INFO     start_spiral_os:start_spiral_os.py:220 Startup self-correction for neutral (tol 0.000)
PASSED                                                                                                                   [  4%]
tests/test_start_spiral_os.py::test_server_and_reflection_run 
-------------------------------------------------------- live log call ---------------------------------------------------------
INFO     emotional_state:emotional_state.py:198 last_emotion set to neutral
INFO     start_spiral_os:start_spiral_os.py:212 Project summary: None
INFO     start_spiral_os:start_spiral_os.py:220 Startup self-correction for neutral (tol 0.000)
PASSED                                                                                                                   [  5%]
tests/test_start_spiral_os.py::test_boot_diagnostics_recovery 
-------------------------------------------------------- live log call ---------------------------------------------------------
ERROR    start_spiral_os:start_spiral_os.py:141 Server module unavailable; API server will not start
ERROR    start_spiral_os:start_spiral_os.py:151 Invocation engine unavailable; related features disabled
PASSED                                                                                                                   [  6%]
tests/test_start_spiral_os.py::test_validator_blocks_prompt 
-------------------------------------------------------- live log call ---------------------------------------------------------
INFO     emotional_state:emotional_state.py:198 last_emotion set to neutral
INFO     start_spiral_os:start_spiral_os.py:212 Project summary: None
INFO     start_spiral_os:start_spiral_os.py:220 Startup self-correction for neutral (tol 0.000)
PASSED                                                                                                                   [  7%]
tests/test_start_spiral_os.py::test_no_validator_option 
-------------------------------------------------------- live log call ---------------------------------------------------------
INFO     emotional_state:emotional_state.py:198 last_emotion set to neutral
INFO     start_spiral_os:start_spiral_os.py:212 Project summary: None
INFO     start_spiral_os:start_spiral_os.py:220 Startup self-correction for neutral (tol 0.000)
PASSED                                                                                                                   [  8%]
tests/test_start_spiral_os.py::test_rewrite_memory_option PASSED                                                         [  9%]
tests/test_start_spiral_os.py::test_rewrite_memory_failure PASSED                                                        [ 10%]
tests/test_start_spiral_os.py::test_boot_diagnostics_fatal PASSED                                                        [ 11%]
tests/test_start_spiral_os.py::test_rewrite_memory_missing_dependencies 
-------------------------------------------------------- live log call ---------------------------------------------------------
WARNING  start_spiral_os:start_spiral_os.py:64 Vector memory module missing; system status not stored
ERROR    start_spiral_os:start_spiral_os.py:151 Invocation engine unavailable; related features disabled
PASSED                                                                                                                   [ 12%]
tests/test_start_spiral_os.py::test_invoke_ritual_requires_engine 
-------------------------------------------------------- live log call ---------------------------------------------------------
ERROR    start_spiral_os:start_spiral_os.py:151 Invocation engine unavailable; related features disabled
PASSED                                                                                                                   [ 13%]
tests/test_start_spiral_os.py::test_web_console_registers_connector 
-------------------------------------------------------- live log call ---------------------------------------------------------
INFO     emotional_state:emotional_state.py:198 last_emotion set to neutral
INFO     start_spiral_os:start_spiral_os.py:212 Project summary: None
INFO     start_spiral_os:start_spiral_os.py:220 Startup self-correction for neutral (tol 0.000)
PASSED                                                                                                                   [ 15%]
tests/test_start_spiral_os.py::test_personality_alias_resolution 
-------------------------------------------------------- live log call ---------------------------------------------------------
INFO     emotional_state:emotional_state.py:198 last_emotion set to neutral
INFO     start_spiral_os:start_spiral_os.py:212 Project summary: None
INFO     start_spiral_os:start_spiral_os.py:220 Startup self-correction for neutral (tol 0.000)
PASSED                                                                                                                   [ 16%]
tests/test_start_spiral_os.py::test_keyboard_interrupt_prints_blank_line 
-------------------------------------------------------- live log call ---------------------------------------------------------
INFO     emotional_state:emotional_state.py:198 last_emotion set to neutral
INFO     start_spiral_os:start_spiral_os.py:212 Project summary: None
INFO     start_spiral_os:start_spiral_os.py:220 Startup self-correction for neutral (tol 0.000)
PASSED                                                                                                                   [ 17%]
tests/test_spiral_os.py::test_deploy_pipeline_runs_commands[True] 
-------------------------------------------------------- live log call ---------------------------------------------------------
INFO     spiral_os:spiral_os:43 Running command: echo hello
PASSED                                                                                                                   [ 18%]
tests/test_spiral_os.py::test_deploy_pipeline_runs_commands[False] 
-------------------------------------------------------- live log call ---------------------------------------------------------
INFO     spiral_os:spiral_os:43 Running command: echo hello
PASSED                                                                                                                   [ 19%]
tests/test_spiral_os.py::test_deploy_pipeline_multiline[True] 
-------------------------------------------------------- live log call ---------------------------------------------------------
INFO     spiral_os:spiral_os:43 Running command: echo hello         world

PASSED                                                                                                                   [ 20%]
tests/test_spiral_os.py::test_deploy_pipeline_multiline[False] 
-------------------------------------------------------- live log call ---------------------------------------------------------
INFO     spiral_os:spiral_os:43 Running command: echo hello         world

PASSED                                                                                                                   [ 21%]
tests/test_spiral_os.py::test_deploy_pipeline_invalid_yaml 
-------------------------------------------------------- live log call ---------------------------------------------------------
ERROR    spiral_os:spiral_os:32 Failed to parse pipeline YAML /tmp/pytest-of-root/pytest-11/test_deploy_pipeline_invalid_y0/p.yaml: mapping values are not allowed here
  in "<unicode string>", line 1, column 14:
    :: not yaml ::
                 ^
PASSED                                                                                                                   [ 22%]
tests/test_spiral_os.py::test_deploy_pipeline_command_failure 
-------------------------------------------------------- live log call ---------------------------------------------------------
ERROR    spiral_os:spiral_os:46 Command failed with exit code 1: bad
PASSED                                                                                                                   [ 23%]
tests/test_spiral_os.py::test_deploy_pipeline_missing_file 
-------------------------------------------------------- live log call ---------------------------------------------------------
ERROR    spiral_os:spiral_os:27 Unable to read pipeline YAML /tmp/pytest-of-root/pytest-11/test_deploy_pipeline_missing_f0/absent.yaml: [Errno 2] No such file or directory: '/tmp/pytest-of-root/pytest-11/test_deploy_pipeline_missing_f0/absent.yaml'
PASSED                                                                                                                   [ 24%]
tests/test_spiral_os.py::test_cli_main_pipeline_deploy 
-------------------------------------------------------- live log call ---------------------------------------------------------
INFO     spiral_os:spiral_os:43 Running command: echo hi
PASSED                                                                                                                   [ 25%]
tests/test_spiral_os.py::test_cli_main_prints_usage PASSED                                                               [ 26%]
tests/test_spiral_os.py::test_hf_stub_behaviour PASSED                                                                   [ 27%]
tests/test_spiral_os.py::test_chakra_cycle_emits_events PASSED                                                           [ 29%]
tests/test_spiral_os.py::test_chakra_cycle_scheduler_yields PASSED                                                       [ 30%]
tests/test_spiral_os.py::test_pulse_emitter_broadcast PASSED                                                             [ 31%]
tests/test_spiral_os.py::test_pulse_emitter_run_wrapper PASSED                                                           [ 32%]
tests/test_spiral_os.py::test_pkg_start_invoke_ritual PASSED                                                             [ 33%]
tests/test_spiral_os.py::test_pkg_start_requires_invocation_engine PASSED                                                [ 34%]
tests/test_spiral_os.py::test_src_start_invoke_ritual PASSED                                                             [ 35%]
tests/test_spiral_os.py::test_src_start_rewrite_memory PASSED                                                            [ 36%]
tests/test_spiral_os.py::test_src_start_command_loop_with_validator 
-------------------------------------------------------- live log call ---------------------------------------------------------
INFO     src.spiral_os.start_spiral_os:start_spiral_os.py:182 Project summary: purpose
INFO     src.spiral_os.start_spiral_os:start_spiral_os.py:190 Startup self-correction for calm (tol 0.500)
PASSED                                                                                                                   [ 37%]
tests/test_spiral_os.py::test_src_start_personality_alias 
-------------------------------------------------------- live log call ---------------------------------------------------------
INFO     src.spiral_os.start_spiral_os:start_spiral_os.py:182 Project summary: purpose
INFO     src.spiral_os.start_spiral_os:start_spiral_os.py:190 Startup self-correction for calm (tol 0.500)
PASSED                                                                                                                   [ 38%]
tests/test_spiral_os.py::test_src_start_keyboard_interrupt 
-------------------------------------------------------- live log call ---------------------------------------------------------
INFO     src.spiral_os.start_spiral_os:start_spiral_os.py:182 Project summary: purpose
INFO     src.spiral_os.start_spiral_os:start_spiral_os.py:190 Startup self-correction for calm (tol 0.500)
PASSED                                                                                                                   [ 39%]
tests/test_spiral_os.py::test_src_cli_deploy_pipeline PASSED                                                             [ 40%]
tests/test_spiral_os.py::test_src_cli_deploy_requires_steps PASSED                                                       [ 41%]
tests/test_spiral_os.py::test_src_cli_main_dispatch PASSED                                                               [ 43%]
tests/test_spiral_memory.py::test_spiral_memory_register_and_recall PASSED                                               [ 44%]
tests/test_spiral_memory.py::test_optional_spiral_memory_recall PASSED                                                   [ 45%]
tests/test_spiral_memory.py::test_register_event_handles_glyph_failure 
-------------------------------------------------------- live log call ---------------------------------------------------------
ERROR    spiral_memory:spiral_memory.py:137 glyph generation failed: boom
Traceback (most recent call last):
  File "/workspace/ABZU/spiral_memory.py", line 134, in register_event
    path, phrase = generate_sacred_glyph(layers)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspace/ABZU/tests/test_spiral_memory.py", line 58, in _raise
    raise RuntimeError("boom")
RuntimeError: boom
PASSED                                                                                                                   [ 46%]
tests/test_spiral_memory.py::test_register_event_records_glyph PASSED                                                    [ 47%]
tests/test_spiral_memory.py::test_connect_adds_missing_columns PASSED                                                    [ 48%]
tests/test_spiral_memory.py::test_recall_with_torch_stub PASSED                                                          [ 49%]
tests/test_vector_memory.py::test_add_and_search PASSED                                                                  [ 50%]
tests/test_vector_memory.py::test_embed_and_similarity_without_numpy PASSED                                              [ 51%]
tests/test_vector_memory.py::test_rewrite_vector_delete_failure 
-------------------------------------------------------- live log call ---------------------------------------------------------
ERROR    vector_memory:vector_memory.py:411 Failed to rewrite vector old
Traceback (most recent call last):
  File "/workspace/ABZU/vector_memory.py", line 407, in rewrite_vector
    store.rewrite(old_id, emb_list, meta)
  File "/workspace/ABZU/tests/test_vector_memory.py", line 93, in rewrite
    raise RuntimeError("update failed")
RuntimeError: update failed
PASSED                                                                                                                   [ 52%]
tests/test_vector_memory.py::test_persist_and_restore_snapshot PASSED                                                    [ 53%]
tests/test_vector_memory.py::test_persist_clusters PASSED                                                                [ 54%]
tests/test_vector_memory.py::test_optional_vector_memory_noops PASSED                                                    [ 55%]
tests/test_vector_memory.py::test_configure_requires_distributed PASSED                                                  [ 56%]
tests/test_vector_memory.py::test_add_vector_retries_with_legacy_signature PASSED                                        [ 58%]
tests/test_vector_memory.py::test_search_uses_native_search PASSED                                                       [ 59%]
tests/test_vector_memory.py::test_rewrite_vector_updates_store PASSED                                                    [ 60%]
tests/test_vector_memory.py::test_restore_latest_snapshot_fallback 
-------------------------------------------------------- live log call ---------------------------------------------------------
ERROR    vector_memory:vector_memory.py:576 failed to restore snapshot
Traceback (most recent call last):
  File "/workspace/ABZU/vector_memory.py", line 573, in restore_latest_snapshot
    restore(snaps[-1])
  File "/workspace/ABZU/tests/test_vector_memory.py", line 268, in <lambda>
    lambda path: (_ for _ in ()).throw(RuntimeError("boom")),
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspace/ABZU/tests/test_vector_memory.py", line 268, in <genexpr>
    lambda path: (_ for _ in ()).throw(RuntimeError("boom")),
RuntimeError: boom
PASSED                                                                                                                   [ 61%]
tests/test_vector_memory.py::test_compact_removes_stale_entries PASSED                                                   [ 62%]
tests/test_vector_memory.py::test_snapshot_without_native_support PASSED                                                 [ 63%]
tests/test_vector_memory.py::test_configure_with_distributed_and_shards PASSED                                           [ 64%]
tests/test_vector_memory.py::test_vacuum_files_invokes_sqlite PASSED                                                     [ 65%]
tests/test_vector_memory.py::test_after_write_triggers_snapshot PASSED                                                   [ 66%]
tests/test_vector_memory.py::test_after_write_snapshot_without_shards PASSED                                             [ 67%]
tests/test_vector_memory.py::test_add_vectors_batches PASSED                                                             [ 68%]
tests/test_vector_memory.py::test_decay_modes PASSED                                                                     [ 69%]
tests/test_vector_memory.py::test_search_with_collection_search PASSED                                                   [ 70%]
tests/test_vector_memory.py::test_search_without_numpy PASSED                                                            [ 72%]
tests/test_vector_memory.py::test_search_batch PASSED                                                                    [ 73%]
tests/test_vector_memory.py::test_rewrite_vector_with_distributed PASSED                                                 [ 74%]
tests/test_vector_memory.py::test_query_vectors_filters PASSED                                                           [ 75%]
tests/test_vector_memory.py::test_compactor_waits_for_interval PASSED                                                    [ 76%]
tests/test_vector_memory.py::test_start_compaction_thread PASSED                                                         [ 77%]
tests/test_vector_memory.py::test_snapshot_with_native_snapshot PASSED                                                   [ 78%]
tests/test_vector_memory.py::test_restore_directory_with_restore_method PASSED                                           [ 79%]
tests/test_vector_memory.py::test_persist_snapshot_normalizes_manifest PASSED                                            [ 80%]
tests/test_vector_memory.py::test_restore_latest_snapshot_success PASSED                                                 [ 81%]
tests/test_vector_memory.py::test_cluster_vectors_with_stub PASSED                                                       [ 82%]
tests/test_vector_memory.py::test_persist_clusters_with_path PASSED                                                      [ 83%]
tests/test_vector_memory.py::test_load_latest_clusters_edge_cases 
-------------------------------------------------------- live log call ---------------------------------------------------------
ERROR    vector_memory:vector_memory.py:664 failed to load cluster manifest
Traceback (most recent call last):
  File "/workspace/ABZU/vector_memory.py", line 658, in load_latest_clusters
    entries = json.loads(manifest.read_text(encoding="utf-8"))
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/.pyenv/versions/3.12.10/lib/python3.12/json/__init__.py", line 346, in loads
    return _default_decoder.decode(s)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/.pyenv/versions/3.12.10/lib/python3.12/json/decoder.py", line 338, in decode
    obj, end = self.raw_decode(s, idx=_w(s, 0).end())
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/.pyenv/versions/3.12.10/lib/python3.12/json/decoder.py", line 356, in raw_decode
    raise JSONDecodeError("Expecting value", s, err.value) from None
json.decoder.JSONDecodeError: Expecting value: line 1 column 1 (char 0)
PASSED                                                                                                                   [ 84%]
tests/test_vector_memory_extensions.py::test_persistence_with_snapshot SKIPPED (faiss and numpy required)                [ 86%]
tests/test_vector_memory_extensions.py::test_decay_weighting SKIPPED (faiss and numpy required)                          [ 87%]
tests/test_vector_memory_extensions.py::test_distributed_backup SKIPPED (faiss and numpy required)                       [ 88%]
tests/test_vector_memory_extensions.py::test_background_compaction SKIPPED (faiss and numpy required)                    [ 89%]
tests/test_vector_memory_extensions.py::test_auto_snapshot_and_compaction SKIPPED (faiss and numpy required)             [ 90%]
tests/test_vector_memory_extensions.py::test_clustering SKIPPED (faiss and numpy required)                               [ 91%]
tests/test_vector_memory_extensions.py::test_cluster_vectors_with_insufficient_points SKIPPED (faiss and numpy required) [ 92%]
tests/test_vector_memory_persistence.py::test_persistence_across_restart PASSED                                          [ 93%]
tests/test_spiral_vector_db.py::test_insert_and_query PASSED                                                             [ 94%]
tests/test_spiral_vector_db.py::test_insert_embeddings_without_vectors PASSED                                            [ 95%]
tests/test_spiral_vector_db.py::test_query_embeddings_filters_and_empty PASSED                                           [ 96%]
tests/test_spiral_vector_db.py::test_init_db_requires_chromadb PASSED                                                    [ 97%]
tests/test_spiral_vector_db.py::test_init_db_custom_path_and_empty_data PASSED                                           [ 98%]
tests/test_spiral_vector_db.py::test_insert_and_query_without_numpy PASSED                                               [100%]/root/.pyenv/versions/3.12.10/lib/python3.12/site-packages/coverage/inorout.py:521: CoverageWarning: Module start_spiral_os was never imported. (module-not-imported)
  self.warn(f"Module {pkg} was never imported.", slug="module-not-imported")
/root/.pyenv/versions/3.12.10/lib/python3.12/site-packages/coverage/inorout.py:537: CoverageWarning: Module spiral_memory was previously imported, but not measured (module-not-measured)
  self.warn(msg, slug="module-not-measured")
/root/.pyenv/versions/3.12.10/lib/python3.12/site-packages/coverage/inorout.py:537: CoverageWarning: Module vector_memory was previously imported, but not measured (module-not-measured)
  self.warn(msg, slug="module-not-measured")


======================================================= warnings summary =======================================================
agents/interaction_log.py:16
  /workspace/ABZU/agents/interaction_log.py:16: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    entry.setdefault("timestamp", datetime.utcnow().isoformat())

tests/test_spiral_memory.py::test_spiral_memory_register_and_recall
tests/test_spiral_memory.py::test_spiral_memory_register_and_recall
tests/test_spiral_memory.py::test_register_event_handles_glyph_failure
tests/test_spiral_memory.py::test_register_event_records_glyph
tests/test_spiral_memory.py::test_recall_with_torch_stub
  /workspace/ABZU/spiral_memory.py:145: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    (datetime.utcnow().isoformat(), event, glyph_path, phrase),

tests/test_vector_memory.py::test_add_and_search
  /workspace/ABZU/tests/test_vector_memory.py:65: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    now = datetime.utcnow()

tests/test_vector_memory.py::test_add_and_search
tests/test_vector_memory.py::test_add_and_search
tests/test_vector_memory.py::test_add_and_search
tests/test_vector_memory.py::test_add_vector_retries_with_legacy_signature
tests/test_vector_memory_persistence.py::test_persistence_across_restart
  /workspace/ABZU/vector_memory.py:278: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    meta.setdefault("timestamp", datetime.utcnow().isoformat())

tests/test_vector_memory.py::test_add_and_search
tests/test_vector_memory.py::test_add_and_search
tests/test_vector_memory.py::test_add_and_search
tests/test_vector_memory_persistence.py::test_persistence_across_restart
  /workspace/ABZU/vector_memory.py:146: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    "timestamp": datetime.utcnow().isoformat(),

tests/test_vector_memory.py: 11 warnings
  /workspace/ABZU/vector_memory.py:314: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    age = (datetime.utcnow() - t).total_seconds()

tests/test_vector_memory.py::test_rewrite_vector_delete_failure
tests/test_vector_memory.py::test_rewrite_vector_updates_store
tests/test_vector_memory.py::test_rewrite_vector_with_distributed
  /workspace/ABZU/vector_memory.py:400: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    meta.setdefault("timestamp", datetime.utcnow().isoformat())

tests/test_vector_memory.py::test_persist_and_restore_snapshot
tests/test_vector_memory.py::test_persist_snapshot_normalizes_manifest
tests/test_vector_memory_persistence.py::test_persistence_across_restart
  /workspace/ABZU/vector_memory.py:536: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    stamp = datetime.utcnow().strftime("%Y%m%d%H%M%S")

tests/test_vector_memory.py::test_persist_clusters
  /workspace/ABZU/vector_memory.py:628: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    stamp = datetime.utcnow().strftime("%Y%m%d%H%M%S")

tests/test_vector_memory.py::test_search_uses_native_search
  /workspace/ABZU/tests/test_vector_memory.py:207: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    now = datetime.utcnow().isoformat()

tests/test_vector_memory.py::test_compact_removes_stale_entries
  /workspace/ABZU/tests/test_vector_memory.py:278: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    old = datetime.utcnow() - timedelta(days=10)

tests/test_vector_memory.py::test_compact_removes_stale_entries
  /workspace/ABZU/tests/test_vector_memory.py:281: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    "fresh": {"timestamp": datetime.utcnow().isoformat()},

tests/test_vector_memory.py::test_decay_modes
  /workspace/ABZU/tests/test_vector_memory.py:427: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    now = datetime.utcnow().isoformat()

tests/test_vector_memory.py::test_decay_modes
  /workspace/ABZU/tests/test_vector_memory.py:431: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    ts = (datetime.utcnow() - timedelta(seconds=1)).isoformat()

tests/test_vector_memory.py::test_search_with_collection_search
  /workspace/ABZU/tests/test_vector_memory.py:444: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    now = datetime.utcnow().isoformat()

tests/test_vector_memory.py::test_search_without_numpy
  /workspace/ABZU/tests/test_vector_memory.py:471: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    now = datetime.utcnow().isoformat()

tests/test_vector_memory.py::test_compactor_waits_for_interval
  /workspace/ABZU/tests/test_vector_memory.py:521: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    metadata={"stale": {"timestamp": (datetime.utcnow() - timedelta(days=2)).isoformat()}},

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
======================================================== tests coverage ========================================================
_______________________________________ coverage: platform linux, python 3.12.10-final-0 _______________________________________

Name                               Stmts   Miss Branch BrPart  Cover
--------------------------------------------------------------------
spiral_memory.py                      81      1     22      2    97%
spiral_os                             47      2     10      3    91%
spiral_vector_db/__init__.py          80      1     32      3    96%
src/spiral_os/__init__.py              1      0      0      0   100%
src/spiral_os/__main__.py             49      9     12      2    82%
src/spiral_os/_hf_stub.py              4      0      0      0   100%
src/spiral_os/chakra_cycle.py         41      1      6      1    96%
src/spiral_os/pulse_emitter.py        16      0      2      0   100%
src/spiral_os/start_spiral_os.py     145     14     38      8    88%
start_spiral_os.py                   166      7     44      3    94%
vector_memory.py                     393     16    140     19    93%
--------------------------------------------------------------------
TOTAL                               1023     51    306     41    93%
Required test coverage of 90% reached. Total coverage: 92.93%
=================================== 86 passed, 7 skipped, 2 deselected, 42 warnings in 6.35s ===================================
[2025-09-19T22:07:46Z] Exporting coverage reports
Wrote JSON report to /workspace/ABZU/coverage.json
Wrote HTML report to htmlcov/index.html
/root/.pyenv/versions/3.12.10/lib/python3.12/site-packages/coverage_badge/__main__.py:7: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  import pkg_resources
Error: "/workspace/ABZU/coverage.svg" already exists.
Traceback (most recent call last):
  File "/workspace/ABZU/scripts/export_coverage.py", line 148, in <module>
    main()
  File "/workspace/ABZU/scripts/export_coverage.py", line 54, in main
    subprocess.run(
  File "/root/.pyenv/versions/3.12.10/lib/python3.12/subprocess.py", line 571, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['coverage-badge', '-o', '/workspace/ABZU/coverage.svg']' returned non-zero exit status 1.
[2025-09-19T22:07:50Z] Archiving coverage artifacts
[2025-09-19T22:07:50Z] Acceptance tests completed
