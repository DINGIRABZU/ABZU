# APSU Migration Matrix

This matrix consolidates the status of legacy APSU entry points and their Neo-APSU counterparts. Each row lists the legacy module, the Rust crate or PyO3 bridge replacing it, the current migration state, and known defects recorded in readiness packets or doctrine logs. The machine-readable representation lives in `component_index.json` under `apsu_migration`.

| Legacy Entry Point | Neo-APSU Module / Crate | Sandbox Expectation | Hardware Expectation | Evidence Status |
| --- | --- | --- | --- | --- |
| `crown_router` | `neoabzu_crown` | Runs the Rust router in both sandbox and staging with no Python fallback remaining in readiness bundles.【F:component_index.json†L4-L17】 | Maintain Stage G parity checks during gate-runner replays so routing hashes stay aligned across hardware bridges.【F:logs/stage_g/20251102T090000Z-stage_g_gate_runner_hardware/summary.json†L1-L13】 | Confirmed – Stage G parity ledger signed by ops, hardware, and QA leads.【F:logs/stage_g/20251102T090000Z-stage_g_gate_runner_hardware/approvals.yaml†L1-L12】 |
| `identity_loader.py` | `neoabzu_crown::load_identity` | PyO3 identity synthesis executes during sandbox boots with fingerprint telemetry enabled.【F:component_index.json†L10-L21】【F:init_crown_agent.py†L21-L44】 | Continue verifying identity fingerprints on hardware during Stage G/Stage H replays to keep ledger lineage intact.【F:logs/stage_g/20251102T094500Z-stage_g_neo_apsu_parity/summary.json†L1-L13】 | Confirmed – approvals bundle records hardware replay of the identity bridge.【F:logs/stage_g/20251102T094500Z-stage_g_neo_apsu_parity/approvals.yaml†L1-L12】 |
| `crown_decider.py` | `neoabzu_crown::route_decision` | Sandbox still swaps in the legacy stub, blocking full MoGE telemetry during rehearsals.【F:docs/PROJECT_STATUS.md†L180-L187】 | Stage F hardware replay must exercise the Rust decider using the Stage B rotation ledger once access returns.【F:docs/stage_f_hardware_replay_plan.md†L11-L21】 | Provisional – sandbox-only evidence pending hardware bridge execution.【F:docs/PROJECT_STATUS.md†L182-L187】 |
| `crown_prompt_orchestrator.py` | `neoabzu_rag::MoGEOrchestrator` | Mission retrieval remains stubbed in Codex sandbox runs, limiting parity dashboards.【F:docs/PROJECT_STATUS.md†L182-L187】 | Stage F replays queue the Rust orchestrator with recorded Stage C/E handshake diffs when hardware access resumes.【F:docs/stage_f_hardware_replay_plan.md†L17-L25】 | Provisional – sandbox capture only; hardware parity outstanding.【F:docs/PROJECT_STATUS.md†L182-L187】 |
| `state_transition_engine.py` | `neoabzu_crown::route_inevitability` | Sandbox inevitability traces rely on deterministic Python output without Rust diagnostics.【F:docs/PROJECT_STATUS.md†L182-L187】 | Gate-runner hardware run must emit inevitability spans from the Rust bridge per the Stage F plan.【F:docs/stage_f_hardware_replay_plan.md†L25-L33】 | Provisional – sandbox evidence flagged in readiness packet awaiting replay.【F:docs/PROJECT_STATUS.md†L182-L187】 |
| `servant_model_manager.py` | `neoabzu_crown` servant bridge | Sandbox registry stub hides servant telemetry, keeping contract metrics deferred.【F:docs/PROJECT_STATUS.md†L182-L187】 | Hardware replay should activate the Rust-managed registry to record servant lifecycle metrics.【F:docs/stage_f_hardware_replay_plan.md†L21-L29】 | Provisional – sandbox data only; hardware validation queued.【F:docs/PROJECT_STATUS.md†L182-L187】 |
| `emotional_state.py` | `neoabzu_crown` expression pipeline | Aura persistence still runs through the in-memory shim during sandbox rehearsals.【F:docs/PROJECT_STATUS.md†L182-L187】 | Stage F window validates the Rust expression telemetry against live sensors once hardware slots reopen.【F:docs/stage_f_hardware_replay_plan.md†L33-L41】 | Provisional – sandbox shim noted in readiness bundle waiting hardware replay.【F:docs/PROJECT_STATUS.md†L182-L187】 |
| `memory_store.py` | `neoabzu_memory::MemoryBundle` | Sandbox uses optional bundle stubs when the Rust library is unavailable, leaving `cortex layer empty` warnings in evidence.【F:docs/PROJECT_STATUS.md†L186-L187】【F:logs/stage_c/20250927T201020Z-stage_c3_readiness_sync/summary.json†L590-L627】 | Stage F parity run rebuilds the Rust bundle on hardware to confirm all eight layers report ready with native checksums.【F:docs/stage_f_hardware_replay_plan.md†L33-L39】 | Provisional – sandbox-only bundle hash; hardware checksum pending.【F:docs/PROJECT_STATUS.md†L186-L187】 |
| `connectors/operator_mcp_adapter.py` | REST↔gRPC transport via `operator_api`/`operator_api_grpc` | Sandbox parity exercises the adapter but omits heartbeat latency until credentials unlock hardware probes.【F:docs/PROJECT_STATUS.md†L174-L205】 | Stage F/H hardware replays must capture heartbeat payloads and latency spans alongside sandbox traces.【F:docs/stage_f_hardware_replay_plan.md†L39-L47】 | Provisional – transport telemetry marked environment-limited until hardware replay executes.【F:docs/PROJECT_STATUS.md†L174-L205】 |

## Usage

- Update this table and the `apsu_migration` array whenever migration status changes, including defect references and readiness evidence.
- Contract tests for ported rows live under `tests/apsu_migration/` to compare legacy Python behavior with PyO3 shims in a sandbox-safe manner.

## Related Artifacts

- [Migration Crosswalk](../NEOABZU/docs/migration_crosswalk.md)
- [System Blueprint](system_blueprint.md)
- [Project Status – Stage D backlog](PROJECT_STATUS.md#stage-d-bridge-snapshot)
