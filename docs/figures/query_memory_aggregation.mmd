%% Query memory aggregation diagram
%% Version: v1.1.0
%% Last updated: 2025-10-07
graph TD
    Caller[Caller] --> MB[MemoryBundle.query]
    MB --> QM[query_memory]
    QM --> Cortex[Cortex store]
    QM --> Vector[Vector store]
    QM --> Spiral[Spiral store]
    Cortex --> QM
    Vector --> QM
    Spiral --> QM
    QM --> Failed[failed_layers ← error statuses]
    QM --> MB
    MB --> Caller
    subgraph Legend[Status Legend]
        Ready[ready → include results]
        SkippedLegend[skipped → empty responses]
        ErrorLegend[error → add to failed_layers]
    end

