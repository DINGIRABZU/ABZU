%% Memory bundle initialization and query aggregation diagram
%% Version: v1.2.0
%% Last updated: 2025-10-07
flowchart LR
    subgraph Init[Layer Initialization]
        MBInit[MemoryBundle.initialize] --> Bus[(EventBus: memory)]
        Bus --> Cortex[Cortex]
        Bus --> Emotional[Emotional]
        Bus --> Mental[Mental]
        Bus --> Spiritual[Spiritual]
        Bus --> Narrative[Narrative]
    end
    subgraph Legend[Status Legend]
        Ready[ready → canonical layer online]
        Skipped[skipped → Python fallback engaged]
        Error[error → initialization failed]
    end
    subgraph Query[Query Aggregation]
        Caller[Caller] --> MBQuery[MemoryBundle.query]
        MBQuery --> QCortex[Cortex]
        MBQuery --> QEmotional[Emotional]
        MBQuery --> QMental[Mental]
        MBQuery --> QSpiritual[Spiritual]
        MBQuery --> QNarrative[Narrative]
        QCortex --> MBQuery
        QEmotional --> MBQuery
        QMental --> MBQuery
        QSpiritual --> MBQuery
        QNarrative --> MBQuery
        MBQuery --> Caller
    end
